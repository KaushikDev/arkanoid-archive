<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0"/>
    <title>Arkanoid</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	
	  <style>
    	body { padding: 0; margin: 0; background:black ;}
    	canvas { background:black ; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas"></canvas>

<div style="text-align: center;">
<p style="color:white"><i class="fa fa-copyright" ></i>KaushikCodeArts : App by Piyush Kaushik</p>
</div>

       <div style="text-align: center;word-spacing: 30px;">
	 <a id="fb" class="btn btn-default text-center" style="background-color:transparent;border-color:transparent;font-style:bold;" href="https://www.facebook.com/sharer/sharer.php?u=https://KaushikDev.github.io/Arkanoid" target="_blank"><i class="fa fa-facebook" style="color:white;font-size:30px;"></i></a>
	 
         <a id="whatsapp" class="btn btn-default text-center" style="background-color:transparent;border-color:transparent;font-style:bold;" href="whatsapp://send?text=https://KaushikDev.github.io/Arkanoid"><i class="fa fa-whatsapp" style="color:white;font-size:30px;"></i></a>
		 
         <a id="tweet" class="btn btn-default text-center" style="background-color:transparent;border-color:transparent;" href="https://twitter.com/home?status=https://KaushikDev.github.io/Arkanoid" target="_blank"><i class="fa fa-twitter"  style="color:white;font-size:30px;font-style:bold;"></i></a>
               </div>
        

<script>
	var canvas = document.getElementById("myCanvas");
	var ctx = canvas.getContext("2d");
	
	canvas.width = window.innerWidth;
	canvas.height = window.innerHeight* 0.85;
	
	var x = canvas.width/2;
	var y = canvas.height-30;
	
	var dx = 2;
	var dy = -2;
	
	var ballRadius = 20;
	var ballDec = 0.20;
	
	var paddleHeight = 10;
	var paddleWidth = 90;
	var paddleX = (canvas.width-paddleWidth)/2;
	var paddleDec = 1;
	
	var rightPressed = false;
	var leftPressed = false;
	
	var soundHitBrick =  new sound("hitBrick.wav");
	var soundHitPaddle =  new sound("hitPaddle.ogg");
	var soundHitFloor =  new sound("hitFloor.m4a");
	var score = 0;
	var lives = 3;
	var scoreOffsetLeft = 30;
	var livesOffsetRight = 100;
	var brickWidth = 50;
	var brickHeight = 20;
	
	var brickPadding = 5;
	var brickOffsetTop = 30;
	var brickOffsetLeft = 30;
	var brickRowCount = 10;
	var brickColumnCount = (Math.floor(canvas.width/(brickWidth+brickPadding)));
	console.log("Column count is : "+brickColumnCount);
	
	var bricks = [];
	for (c=0;c<brickColumnCount;c++){
		bricks[c]=[];
		for(r=0;r<brickRowCount;r++){
			//position to paint bricks at the following x,y positions onscreen
			bricks[c][r]={x:0, y:0, status:1};
		}
	
	}
	
		function draw(){
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			drawBall();
			drawPaddle();
			drawBricks();
			drawScore();
			drawLives();
			collisionDetection();
			x += dx;
			y += dy;
			
			//trying to bounce from left and right sides
			if(x+dx > canvas.width-ballRadius || x+dx < ballRadius){
				dx = -dx;
			}
			// trying to bounce from top only and exclude bottom so the game can be over
			if(y+dy < ballRadius){
				dy = -dy;
			}
			else if(y+dy > canvas.height-ballRadius){
				if(x > paddleX && x < paddleX+paddleWidth){
				dy = -dy;
				}
				else{
					soundHitFloor.play();
					lives--;
					if(!lives) {
						alert("You Lost!!\nBetter luck next time.\n\nYour Score : "+score);
						document.location.reload();
					}
					else {
						x = canvas.width/2;
						y = canvas.height-30;
						dx = 2;
						dy = -2;
						paddleX = (canvas.width-paddleWidth)/2;
					}
				}
			}
			//moving paddle and stopping at the right edge
			if(rightPressed && paddleX < canvas.width-paddleWidth){
				paddleX += 10;
			}
			//moving paddle and stopping at the left edge
			if(leftPressed && paddleX > 0){
				paddleX += -10;
			}
		}
		
		function drawBall(){
			ctx.beginPath();
			ctx.arc(x,y,ballRadius,0, Math.PI*2);
			var colorBall = "hsl("+parseInt(Math.random() * 360, 10) + ",  100%, 50%)";
			ctx.fillStyle=colorBall;
			ctx.fill();
			ctx.closePath();
		}
		
		function drawPaddle(){
			ctx.beginPath();
			ctx.rect(paddleX, canvas.height-paddleHeight-1, paddleWidth, paddleHeight);
			//var colorPaddle = "hsl("+parseInt(Math.random() * 360, 10) + ",  100%, 50%)";
			ctx.fillStyle = "skyblue";
			ctx.strokeStyle = "black";
			ctx.stroke();
			ctx.fill();
			ctx.closePath();
		}
		
		function drawBricks(){
			for(c=0;c<brickColumnCount;c++){
				for(r=0;r<brickRowCount;r++){
					if(bricks[c][r].status==1){
						var brickX = (c*(brickWidth+brickPadding))+brickOffsetLeft;
						var brickY = (r*(brickHeight+brickPadding))+brickOffsetTop;
						bricks[c][r].x = brickX;
						bricks[c][r].y = brickY;
						ctx.beginPath();
						//ctx.rect(brickX,brickY,brickWidth,brickHeight);
						var img = new Image();
						img.src = "brick.jpg";
						ctx.drawImage(img, brickX,brickY,brickWidth,brickHeight);
						//
						var colorBrick = "hsl("+parseInt(Math.random() * 360, 10) + ",  100%, 50%)";
						ctx.fillStyle = "white";
						ctx.fill();
						ctx.closePath();
					}
					
				}
			}
		}
		
		function drawScore(){
			ctx.font = "16px Arial";
			ctx.fillStyle = "skyblue";
			ctx.fillText("Score : "+score, scoreOffsetLeft, 20);
		
		}
		
	
		function drawLives() {
			ctx.font = "16px Arial";
			ctx.fillStyle = "skyblue";
			ctx.fillText("Lives: "+lives, canvas.width-livesOffsetRight, 20);
		}
		
		function collisionDetection(){
			for(c=0;c<brickColumnCount;c++){
				for(r=0;r<brickRowCount;r++){
					var b = bricks[c][r];
					if(b.status==1){
						if((x>b.x) && (x<b.x+brickWidth ) && (y>b.y) && (y<b.y+brickHeight)){
							dy = -dy;
							b.status = 0;
							score+=5;
							if(paddleWidth>25){
								paddleWidth -= paddleDec;
							}
							if(ballRadius>5){
								ballRadius -= ballDec;
							}
							//console.log(paddleWidth);
							if(score == brickRowCount*brickColumnCount*5){
								alert("You Won, Champ!!\n\nYour Score : "+score);
								document.location.reload();
							}
						}
					}
					
				}
			}
		}
		
		document.addEventListener("keydown", keyDownHandler, false);
		document.addEventListener("keyup", keyUpHandler, false);
		document.addEventListener("mousemove", mouseMoveHandler, false);
		document.addEventListener("touchmove", touchMoveHandler, false);
		
		function keyDownHandler(e){
			if(e.keyCode==39){
				rightPressed = true;
			}
			else if(e.keyCode==37){
				leftPressed = true;
			}
		
		}
		
		function keyUpHandler(e){
			if(e.keyCode==39){
				rightPressed = false;
			}
			else if(e.keyCode==37){
				leftPressed = false;
			}
		
		}
		
		function mouseMoveHandler(e) {
			var relativeX = e.clientX - canvas.offsetLeft;
			if(relativeX > 0 && relativeX < canvas.width) {
				paddleX = relativeX - paddleWidth/2;
			}
		}
		
		/*function touchMoveHandler(e) {
			var relativeX = e.clientX - canvas.offsetLeft;
			if(relativeX > 0 && relativeX < canvas.width) {
				paddleX = relativeX - paddleWidth/2;
			}
		}*/
		
		function touchMoveHandler(e) {
             var relativeX = e.touches[0].screenX - canvas.offsetLeft;
			if(relativeX > 0 && relativeX < canvas.width) {
				paddleX = relativeX - paddleWidth/2;
			}
        }
		
		function sound(src){
		this.sound = document.createElement("audio");
		this.sound.src = src;
		this.sound.setAttribute("preload", "auto");
		this.sound.setAttribute("controls","none");
		this.sound.style.display="none";
		document.body.appendChild(this.sound);
		this.play = function(){
			this.sound.play();
		}
		this.stop = function(){
			this.sound.pause();
		}
	}
		
		setInterval(draw, 5);
</script>

</body>
</html>
